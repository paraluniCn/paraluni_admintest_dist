(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0e9993"],{"8de6":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-card",{staticClass:"card-contain"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("div",{staticClass:"mb-10"},[a("span",{staticClass:"mb-10"},[e._v("合约选择：")]),a("el-select",{attrs:{placeholder:"请选择"},on:{change:function(t){return e.getMulitList({name:t},1)}},model:{value:e.useMulitkey,callback:function(t){e.useMulitkey=t},expression:"useMulitkey"}},e._l(e.info.mulitList,(function(e){return a("el-option",{key:e.key,attrs:{label:e.label,value:e.key}})})),1)],1),a("el-tabs",{attrs:{type:"card",value:e.useMulitkey},on:{"tab-click":function(t){return e.getMulitList(t,1)}}},e._l(e.info.mulitList,(function(t){return a("el-tab-pane",{key:t.key,attrs:{label:t.label,name:t.key}},[a("div",{staticClass:"mb-20"},[a("el-button",{staticClass:"text item",attrs:{type:"primary"},on:{click:function(t){return e.addNewItem()}}},[e._v(" 创建提案 ")]),a("el-button",{staticClass:"text item",attrs:{type:""},on:{click:function(t){return e.getMulitList({name:e.useMulitkey},e.listPage)}}},[e._v(" 刷新数据 ")])],1),a("div",{staticClass:"mb-20"},[a("el-radio-group",{model:{value:e.radio1,callback:function(t){e.radio1=t},expression:"radio1"}},[a("el-radio",{attrs:{label:"all"}},[e._v("全部")]),a("el-radio",{attrs:{label:"wait"}},[e._v("未执行")]),a("el-radio",{attrs:{label:"success"}},[e._v("已执行")]),a("el-radio",{attrs:{label:"discard"}},[e._v("已废弃")])],1)],1),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.showList}},[a("el-table-column",{attrs:{prop:"id",label:"编号id"}}),a("el-table-column",{attrs:{prop:"time",label:"日期"}}),a("el-table-column",{attrs:{prop:"dec",label:"简述"}}),a("el-table-column",{attrs:{prop:"startAddree",label:"目标地址"}}),a("el-table-column",{attrs:{prop:"submitterShort",label:"提案地址"}}),a("el-table-column",{attrs:{prop:"itemstatus",label:"状态",width:500},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.isConfirmed&&"wait"==t.row.itemstatus?a("el-button",{staticClass:"text item",attrs:{type:"primary"},on:{click:function(a){return e.executeTransaction(t.row)}}},[e._v(" 执行提案 ")]):e._e(),e.isSameAddress(t.row.submitter)&&"wait"==t.row.itemstatus?a("el-button",{staticClass:"text item",attrs:{type:"warning"},on:{click:function(a){return e.abandonmentTransaction(t.row)}}},[e._v(" 废弃提案 ")]):e._e(),"wait"==t.row.itemstatus?a("el-button",{staticClass:"text item",attrs:{type:"info"},on:{click:function(a){return e.getVoteData(t.row)}}},[e._v(" 投票 ")]):e._e(),"success"==t.row.itemstatus?a("div",{staticClass:"text item",staticStyle:{color:"#67c23a"}},[e._v(" 已执行 ")]):e._e(),"discard"==t.row.itemstatus?a("div",{staticClass:"text item",staticStyle:{color:"#e6a23c"}},[e._v(" 已废弃 ")]):e._e()]}}],null,!0)})],1),a("el-pagination",{attrs:{"page-size":e.listPageSize,"pager-count":7,layout:"prev, pager, next",total:e.listLength},on:{"current-change":e.handleCurrentChange}})],1)})),1)],1),a("VoteDialog",{ref:"dialogRef",attrs:{mulitkey:e.useMulitkey}}),a("AddMulitItem",{ref:"addMulitItem"})],1)},n=[],r=a("c7eb"),i=a("1da1"),o=a("5530"),c=(a("b0c0"),a("b64b"),a("e9c4"),a("4de4"),a("d3b7"),a("25f0"),a("d81d"),a("2f62")),l=a("5e3a"),u=a("92ff"),d=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:"投票",visible:e.dialogShow,width:"70%"}},[a("el-descriptions",{staticClass:"mt-10",attrs:{title:e.formData.typeText,column:1,border:!0}},[a("template",{slot:"extra"},[(e.formData.isfavo&&e.formData.canGoPro||!e.formData.canGoPro)&&e.hasRoule?a("el-button",{attrs:{className:"contentButton mb-10",type:e.formData.isfavo?"warning":"primary"},on:{click:function(t){return e.voteProposal(e.formData.isfavo)}}},[e._v(" "+e._s(e.formData.isfavo?"撤回投票("+e.formData.agreeNum+"/"+e.formData.voteLength+")":"赞成("+e.formData.agreeNum+"/"+e.formData.voteLength+")")+" ")]):e._e()],1),a("el-descriptions-item",{attrs:{label:"详细DATA"}},[e._v(" "+e._s(e.formData.data)+" ")]),a("el-descriptions-item",{attrs:{label:"目标地址"}},[e._v(" "+e._s(e.formData.addressName)+" ："+e._s(e.formData.startAddreeLong)+" ")]),a("el-descriptions-item",{attrs:{label:"signature"}},[e._v(" "+e._s(e.formData.dataInfo.signature)+" ")]),a("el-descriptions-item",{attrs:{label:"参数"}},[e._v(" "+e._s(JSON.stringify(e.formData.dataInfo.args.map((function(e){return e.toString()}))))+" ")])],2),a("el-descriptions",{staticClass:"mt-10",attrs:{column:2,border:!0}},[a("el-descriptions-item",{attrs:{label:"BNB 数量"}},[e._v(" "+e._s(e.formData.bnbValue)+" ")])],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e.hasRoule?a("el-button",{attrs:{className:"contentButton mb-10"},on:{click:function(t){return e.getVateTouList()}}},[e._v(" 投票列表列表 ")]):e._e(),a("el-button",{attrs:{type:"primary"},on:{click:e.closeDialog}},[e._v("关闭")])],1)],1)},b=[],m=(a("a15b"),a("99af"),a("3de1")),h={name:"voteDialog",props:{mulitkey:{type:String,required:!0}},data:function(){return{dialogShow:!1,formData:{},hasRoule:!1,showList:[],mulitName:""}},methods:{showDialog:function(e,t,a){this.dialogShow=!0,this.formData=e,this.hasRoule=t,this.mulitName=a},closeDialog:function(){this.dialogShow=!1},getVateTouList:function(){var e=this;return Object(i["a"])(Object(r["a"])().mark((function t(){var a;return Object(r["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(u["d"])(e.formData.id,e.mulitName);case 2:a=t.sent,e.$alert("\n        <div>\n          ".concat(a.map((function(e){return"<div class='flex-row fl-jc-between'>\n            <div>".concat(Object(m["j"])(e.address)," </div>\n            <div>").concat(e.isOked?"已投票":"未投票","</div>\n            \n            </div>")})).join(""),"\n        </div>\n      "),"投票列表",{dangerouslyUseHTMLString:!0});case 4:case"end":return t.stop()}}),t)})))()},voteProposal:function(e){var t=this;return Object(i["a"])(Object(r["a"])().mark((function a(){var s;return Object(r["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(t.hasRoule){a.next=3;break}return t.$message("您不是该多签的议员，无法投票"),a.abrupt("return",!1);case 3:if(s=null,!e){a.next=10;break}return a.next=7,Object(u["l"])(t.mulitName,t.formData.id);case 7:s=a.sent,a.next=13;break;case 10:return a.next=12,Object(u["f"])(t.mulitName,t.formData.id);case 12:s=a.sent;case 13:s&&(t.$message("执行成功"),t.closeDialog());case 14:case"end":return a.stop()}}),a)})))()}}},f=h,p=a("2877"),v=Object(p["a"])(f,d,b,!1,null,null,null),D=v.exports,g=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:"创建提案",visible:e.dialogShow,width:"70%"}},[a("div",{staticClass:"mb-20"},[a("el-select",{attrs:{placeholder:"请选择"},on:{change:e.getChooseData},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}},e._l(e.chooseList,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),e.chooseData.hasSecond?a("div",{staticClass:"mb-20"},[a("el-select",{attrs:{placeholder:"请选择"},on:{change:e.getSecondData},model:{value:e.value2,callback:function(t){e.value2=t},expression:"value2"}},e._l(e.chooseData.secondLsit,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1):e._e(),"0"==e.chooseData.value&&e.secondData.value?a("div",{staticClass:"mb-20"},[e._v(" 可用额度："+e._s(e.banlceOf)+" ")]):e._e(),e.secondData.showTextObj&&e.secondData.showTextObj.length>0?a("div",{staticClass:"mb-20"},e._l(this.secondData.showTextObj,(function(t){return a("div",{staticClass:"mb-10"},[e._v(" "+e._s(t.showText)+"："+e._s(t.showVlaue)+" ")])})),0):e._e(),"16"==e.chooseData.value?a("div",{staticClass:"mb-20"},[e._v(" 可用额度："+e._s(e.bnbbanlceOf)+" ")]):e._e(),e.secondData.paramType&&e.secondData.paramType.length?a("div",{staticClass:"mb-20"},[e._l(e.secondData.paramName,(function(t,s){return a("div",{key:t+s+e.secondData.value,staticClass:"mb-20",attrs:{value:t}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入"+t+":"+e.secondData.paramType[s]},model:{value:e.enterList[s],callback:function(t){e.$set(e.enterList,s,t)},expression:"enterList[index]"}})],1)})),e.secondData.showBNBInput?a("div",{staticClass:"mb-20"},[a("el-input",{attrs:{clearable:"",placeholder:"请输入BNB数量"},model:{value:e.enterBNBnum,callback:function(t){e.enterBNBnum=t},expression:"enterBNBnum"}})],1):e._e()],2):e._e(),!e.chooseData.hasSecond&&e.chooseData.functionData?a("div",{staticClass:"mb-20"},e._l(e.chooseData.functionData.paramName,(function(t,s){return a("div",{key:t+s+e.chooseData.value,staticClass:"mb-20",attrs:{value:t}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入"+t+":"+e.chooseData.functionData.paramType[s]},model:{value:e.enterList[s],callback:function(t){e.$set(e.enterList,s,t)},expression:"enterList[index]"}})],1)})),0):e._e(),e.chooseData.value&&e.secondData.value||e.chooseData.value&&!e.chooseData.hasSecond?a("div",{staticClass:"mb-20"},[a("el-input",{attrs:{clearable:"",placeholder:"请输入提案描述"},model:{value:e.enterDec,callback:function(t){e.enterDec=t},expression:"enterDec"}})],1):e._e(),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogShow=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.submitTiAn}},[e._v("确 定")])],1)])},w=[],O=a("ade3"),j=a("2909"),x=(a("7db0"),a("14d9"),a("159b"),a("b680"),a("6514")),y=a("5d3f"),k=a("bed7"),L=(a("0268"),a("2934")),_=a("291a"),N={name:"voteDialog",props:{},data:function(){return{dialogShow:!1,value:"",value2:"",chooseList:[],chooseData:{},secondData:{},enterList:[],enterDec:"",coinList:[],paramTypeData:{},banlceOf:0,bnbbanlceOf:0,enterBNBnum:""}},created:function(){this.getCoinList()},watch:{},methods:{getCoinList:function(){var e=this;return Object(i["a"])(Object(r["a"])().mark((function t(){var a,s,n,i;return Object(r["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(x["c"])();case 2:a=t.sent,s=a.tokenList,n=Object(j["a"])(s.map((function(e){return{value:e.symbol,label:e.symbol,address:e.symbol===Object(k["b"])().defaultCurrencyName?"":e.address,decimal:e.decimal,abi:"erc20",functionKey:"transfer",paramType:["address","uint256"],paramName:["_users","enterNum"]}}))),n.find((function(e){return"V42"==e.label}))||n.push((i={address:y["a"].V42,decimal:k["a"]["V42"],value:"addUsers"},Object(O["a"])(i,"value","V42"),Object(O["a"])(i,"label","V42"),Object(O["a"])(i,"abi","erc20"),Object(O["a"])(i,"functionKey","transfer"),Object(O["a"])(i,"paramType",["address","uint256"]),Object(O["a"])(i,"paramName",["_users","enterNum"]),i)),e.coinList=Object(j["a"])(n);case 4:case"end":return t.stop()}}),t)})))()},showDialog:function(e,t){var a=this;return Object(i["a"])(Object(r["a"])().mark((function s(){return Object(r["a"])().wrap((function(s){while(1)switch(s.prev=s.next){case 0:return a.dialogShow=!0,a.chooseList=l["a"][t],a.mulitName=t,a.value="",a.value2="",a.chooseData={},a.secondData={},a.hasRoule=e,s.next=10,Object(L["b"])("",y["a"][t],18);case 10:a.bnbbanlceOf=s.sent;case 11:case"end":return s.stop()}}),s)})))()},closeDialog:function(){this.dialogShow=!1},getChooseData:function(e){this.chooseData=this.chooseList.find((function(t){return t.value==e})),"0"==e&&(this.chooseData.secondLsit=this.coinList),this.value2="",this.clearData(!0)},getSecondData:function(e){var t=this;return Object(i["a"])(Object(r["a"])().mark((function a(){var s,n,o,c;return Object(r["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(t.secondData=t.chooseData.secondLsit.find((function(t){return t.value==e})),"0"!=t.chooseData.value){a.next=6;break}return a.next=4,Object(L["b"])(t.secondData.address,y["a"][t.mulitName],t.secondData.decimal);case 4:s=a.sent,t.banlceOf=Object(m["a"])(s);case 6:if(!(t.secondData.muticallData&&t.secondData.muticallData.length>0)){a.next=15;break}return a.next=9,Object(_["a"])(t.secondData.muticallData);case 9:return n=a.sent,o=Object(m["g"])(),a.next=13,o.getBlockNumber();case 13:c=a.sent,t.secondData.showTextObj.forEach(function(){var e=Object(i["a"])(Object(r["a"])().mark((function e(t,a){var s;return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:s=t.dataKey?n[a][t.dataKey]:n[a],t.showVlaue=t.showFun?t.showFun(s,c,n):s;case 2:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}());case 15:t.clearData();case 16:case"end":return a.stop()}}),a)})))()},clearData:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;e&&(this.secondData={}),this.enterList=[],this.enterDec="",this.enterBNBnum="",t&&t()},submitTiAn:function(){var e=this;return Object(i["a"])(Object(r["a"])().mark((function t(){var a,s,n,i,o,c,l,d,b,h,f,p;return Object(r["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a=[],"0"!=e.chooseData.value){t.next=12;break}if(e.secondData.value==Object(k["b"])().defaultCurrencyName){t.next=9;break}return t.next=5,Object(u["o"])(e.enterList[0],Object(m["i"])(e.enterList[1],e.secondData.decimal).toFixed(0,1),e.secondData.address);case 5:s=t.sent,a=[e.secondData.address,0,s],t.next=10;break;case 9:a=[e.enterList[0],Object(m["i"])(e.enterList[1],e.secondData.decimal).toFixed(0,1),"0x"];case 10:t.next=42;break;case 12:if("4"!=e.chooseData.value){t.next=16;break}a=[e.enterList[0],Object(m["i"])(e.enterList[1]||"0",k["a"][Object(k["b"])().defaultCurrencyName]).toFixed(0,1),e.enterList[2]],t.next=42;break;case 16:if("16"!=e.chooseData.value){t.next=20;break}a=[y["a"].WBNB,Object(m["i"])(e.enterList[0]||"0",k["a"][Object(k["b"])().defaultCurrencyName]).toFixed(0,1),e.chooseData.functionData.data],t.next=42;break;case 20:if("17"!=e.chooseData.value&&"117"!=e.chooseData.value){t.next=30;break}return n=JSON.parse(JSON.stringify(e.enterList)),n.shift(),t.next=25,Object(u["h"])(e.chooseData.functionData.functionKey,e.chooseData.functionData.abiObj,n);case 25:i=t.sent,a=[e.enterList[0]||"",Object(m["i"])(e.enterBNBnum||0).toFixed(0,1),i],console.log(a,"enterdata"),t.next=42;break;case 30:return o="",c=e.secondData.address,l=[],d="",b="",e.chooseData.functionData?(c=y["a"][e.mulitName],l=e.chooseData.functionData.paramType,d=e.chooseData.functionData.functionKey.split("-")[0],b=e.chooseData.functionData.abi):(c=e.secondData.address,l=e.secondData.paramType,d=e.secondData.functionKey.split("-")[0],b=e.secondData.abi),h=Object(u["e"])(l,e.enterList),f="".concat(d,"(").concat(l.join(","),")"),t.next=40,Object(u["i"])(c,f,h,b,l);case 40:o=t.sent,a=[c,Object(m["i"])(e.enterBNBnum||0).toFixed(0,1),o];case 42:return t.next=44,Object(u["m"])(e.mulitName,a,e.enterDec);case 44:p=t.sent,p&&e.clearData(!0,(function(){e.chooseData={},e.dialogShow=!1,e.$message("提案成功")}));case 46:case"end":return t.stop()}}),t)})))()}}},C=N,S=Object(p["a"])(C,g,w,!1,null,null,null),B=S.exports,M=a("c843"),T=a("2ef0"),A=a("c030"),V=a("51d3"),$={name:"",components:{VoteDialog:D,AddMulitItem:B},data:function(){return{info:l["a"],showList:[],radio1:"wait",getInfo:{},useMulitkey:"",hasRoule:!1,listLength:0,listPage:1,listPageSize:10}},computed:Object(o["a"])({},Object(c["b"])(["userAddress"])),watch:{radio1:function(e,t){e!=t&&this.getShowList(this.allShowList,"wait"==e)},userAddress:{handler:function(){}}},methods:{isSameAddress:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e.toLocaleLowerCase()==(this.userAddress||"").toLocaleLowerCase()},handleCurrentChange:function(e){this.listPage=e,this.getMulitList({name:this.useMulitkey},e)},getMulitList:function(e){var t=arguments,a=this;return Object(i["a"])(Object(r["a"])().mark((function s(){var n,i;return Object(r["a"])().wrap((function(s){while(1)switch(s.prev=s.next){case 0:return n=t.length>1&&void 0!==t[1]?t[1]:a.listPage,a.$loading(),a.showList=[],s.next=5,Object(u["n"])(e.name,n,a.listPageSize);case 5:return i=s.sent,s.next=8,Object(u["p"])(e.name,a.userAddress);case 8:a.hasRoule=s.sent,a.useMulitkey=e.name,a.listLength=parseInt(i.length),a.allShowList=JSON.parse(JSON.stringify(i.poolArr)),a.getShowList(a.allShowList,"wait"==a.radio1),a.$loading().close();case 14:case"end":return s.stop()}}),s)})))()},getShowList:function(e){var t=this,a=arguments.length>1&&void 0!==arguments[1]&&arguments[1],s=e.filter((function(e,a){return e.itemstatus==t.radio1||"all"==t.radio1}));this.showList=a?JSON.parse(JSON.stringify(s.reverse())):JSON.parse(JSON.stringify(s))},implementFunAfter:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;e?(this.$message("执行成功"),this.getMulitList({name:this.useMulitkey},this.listPage),t&&t()):this.$message("执行失败")},executeTransaction:function(e){var t=this;return Object(i["a"])(Object(r["a"])().mark((function a(){var s;return Object(r["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,Object(u["g"])(t.useMulitkey,e.id);case 2:s=a.sent,t.implementFunAfter(s);case 4:case"end":return a.stop()}}),a)})))()},abandonmentTransaction:function(e){var t=this;return Object(i["a"])(Object(r["a"])().mark((function a(){var s;return Object(r["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,Object(u["a"])(t.useMulitkey,e.id);case 2:s=a.sent,t.implementFunAfter(s);case 4:case"end":return a.stop()}}),a)})))()},getVoteData:function(e){var t=this;return Object(i["a"])(Object(r["a"])().mark((function a(){var s,n,i,o,c,l;return Object(r["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return s=e.id.toString(),a.next=3,Object(u["j"])(t.useMulitkey,s);case 3:return n=a.sent,a.next=6,Object(u["k"])(t.useMulitkey);case 6:i=a.sent,Array.isArray(n)||(n=[n]),n=n.map((function(e){return Object(M["b"])(e).toLocaleLowerCase()}));try{c=Object(T["findKey"])(JSON.parse(JSON.stringify(y["a"])),(function(t){return console.log(t),t.toString().toLocaleLowerCase()==e.startAddreeLong.toLocaleLowerCase()})),l=new A["a"].utils.Interface(V["a"][c]),o=l.parseTransaction({data:e.data})}catch(r){console.log(r),o={signature:"查询失败:更新ABI",args:["查询失败:更新ABI"]}}t.$refs.dialogRef.showDialog({typeText:"提案编号：".concat(s),data:e.data,id:s,voteLength:i.toString(),agreeNum:n.length,canGoPro:n.length>=i,startAddreeLong:e.startAddreeLong,dataInfo:o,addressName:c||"暂无",isfavo:n.indexOf(t.userAddress.toLocaleLowerCase())>-1,bnbValue:Object(m["a"])(e.bnbValue)},t.hasRoule,t.useMulitkey);case 11:case"end":return a.stop()}}),a)})))()},addNewItem:function(){if(!this.hasRoule)return this.$message("您不是该多签的议员，无法投票"),!1;this.$refs.addMulitItem.showDialog(this.hasRoule,this.useMulitkey)}}},I=$,J=Object(p["a"])(I,s,n,!1,null,null,null);t["default"]=J.exports}}]);